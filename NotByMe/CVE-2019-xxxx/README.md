# CVE-2019-8577

This bug is likely the same as the medialibraryd bug from this presentation: (Page 9)

https://media.defcon.org/DEF%20CON%2026/DEF%20CON%2026%20presentations/DEFCON-26-Min-Zheng-Xiaolong-Bai-Fasten-your-Seatbelts-Escaping-iOS-11-Sandbox-Updated.pdf

com.apple.medialibraryd.xpc (/System/Library/PrivateFrameworks/MusicLibrary.framework/Support/medialibraryd) exposes a XPC interface that 
allows querying arbitrary SQLite database outside app container sandbox.

The original PoC doesn't work above iOS 10, but actually it has not been patched until iOS 12.3.

The truth is that from iOS 10, accessing media library requires user approvement (TCC).

![tcc](tcc.png)

This poc will execute arbitrary code in process medialibraryd, but this bug has been mitigated by PAC.
![crashlog](crashlog.jpeg)

After all, it's a nice logic bug that you can read arbitrary SQLite databases, which is a serious privacy issue.
